<?xml version="1.0" encoding="UTF-8" ?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <!-- Spring Oauth2 Schema, see https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql -->
    <changeSet id="1-oauth-seed" author="Fabrizio Rodin-Miron">
        <insert tableName="oauth_client_details">
            <column name="client_id">3d72f001-60be-48f5-ba12-57520950fc6b</column>
            <column name="client_secret">{noop}</column>
            <column name="web_server_redirect_uri">https://localhost:3000/oauth2/redirect</column>
            <column name="scope">read_profile,update_profile</column>
            <column name="access_token_validity">3600</column>
            <column name="refresh_token_validity">864000000</column>
            <column name="resource_ids">oauth2-resource</column>
            <column name="authorized_grant_types">authorization_code,password,refresh_token</column>
            <column name="additional_information">{"description":"Zuccini web app public client"}</column>
        </insert>

        <insert tableName="oauth_client_details">
            <column name="client_id">302a4c05-82ca-4c38-9354-6ba720b1907d</column>
            <column name="client_secret">{noop}</column>
            <column name="web_server_redirect_uri">https://localhost:5000/oauth2/redirect</column>
            <column name="scope">create_profile,read_profile,update_profile,delete_profile</column>
            <column name="access_token_validity">3600</column>
            <column name="refresh_token_validity">864000000</column>
            <column name="resource_ids">oauth2-resource</column>
            <column name="authorized_grant_types">password,refresh_token</column>
            <column name="additional_information">{"description":"Zuccini admin web app public client"}</column>
        </insert>

        <insert tableName="permission">
            <column name="name">create_profile</column>
        </insert>
        <insert tableName="permission">
            <column name="name">read_profile</column>
        </insert>
        <insert tableName="permission">
            <column name="name">update_profile</column>
        </insert>
        <insert tableName="permission">
            <column name="name">delete_profile</column>
        </insert>
        
        <insert tableName="role">
            <column name="name">ROLE_ADMIN</column>
        </insert>
        <insert tableName="role">
            <column name="name">ROLE_USER</column>
        </insert>
        
        <insert tableName="permission_role">
            <column name="permission_id">1</column>
            <column name="role_id">1</column>
        </insert>
        <insert tableName="permission_role">
            <column name="permission_id">2</column>
            <column name="role_id">1</column>
        </insert>
        <insert tableName="permission_role">
            <column name="permission_id">3</column>
            <column name="role_id">1</column>
        </insert>
        <insert tableName="permission_role">
            <column name="permission_id">4</column>
            <column name="role_id">1</column>
        </insert>
        <insert tableName="permission_role">
            <column name="permission_id">2</column>
            <column name="role_id">2</column>
        </insert>
        <insert tableName="permission_role">
            <column name="permission_id">3</column>
            <column name="role_id">2</column>
        </insert>

        <insert tableName="users">
            <column name="username">frodinm</column>
            <column name="first_name">Fabrizio</column>
            <column name="last_name">Rodin-Miron</column>
            <column name="email">fabrizio.rm@skylow.io</column>
            <column name="password">{bcrypt}$2a$12$/gpvNt92RXNpJx52vC3F4.FPGvo4auNNRxAFPIg/2tK6gOUkguX9G</column>
            <column name="provider_id">1234</column>
            <column name="email_verified">true</column>
            <column name="enabled">true</column>
            <column name="account_non_expired">true</column>
            <column name="credentials_non_expired">true</column>
            <column name="account_non_locked">true</column>
        </insert>

        <insert tableName="user_auth_provider">
            <column name="user_id">1</column>
            <column name="provider">EMAIL</column>
        </insert>

        <insert tableName="user_role">
            <column name="role_id">1</column>
            <column name="user_id">1</column>
        </insert>
    </changeSet>
</databaseChangeLog>